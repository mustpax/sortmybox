#{extends 'main.html' /}
%{
    if (user.accountType == models.User.AccountType.BOX)  
        accountType = "Box";
    else
        accountType = "Dropbox";
}%

#{if initResult.createdSortboxDir }
<div class="row">
	<div class="span12">
		<div class="alert alert-info alert-created hide">
			<a class="close" data-dismiss="alert">Ã—</a>
		    <h4 class="alert-heading">SortMyBox created!</h4>
			We created a folder called <strong>SortMyBox</strong> for you in your ${accountType}!
            Save files here to get them sorted based on your rules.<br>
            #{if initResult.createdCannedRules}
	            We also created some rules for you to get you started.
            #{/if}
		</div>
	</div>
</div>

<script>
    _gaq.push(['_trackEvent', 'user', 'reg', '${accountType.escapeJavaScript()}']);
</script>
#{/if}

<div class="row">
  <div class="span12">
    <div class="page-header">
      <h1>${accountType}<small>&trade;</small> Sorting Rules 
        <small>Rules are applied to your SortMyBox folder every 15 minutes.</small>
      </h1>
    </div>
    <table class="rules table table-bordered table-striped">
      <thead>
        <th>When</th>
        <th></th>
        <th>Move file to</th>
        <th></th>
      </thead>
      <tbody>
          #{list items:rules, as:'rule'}
              #{rule rule:rule, class:'rule' /}
          #{/list}
          #{else}
              #{rule class:'rule' /}
          #{/else}

          #{rule class:'rule-template' /}
      </tbody>
      <tfoot>
          <tr class="new-rule-row">
            <td colspan="3"></td>
            <td class="center">
              <button class="btn new">New rule</button>
            </td>
          </tr>
      </tfoot>
    </table>
    <p>
    <a class="btn btn-primary btn-large save">Save &amp; Run Rules</a>
    </p>
  </div>
</div>

<div class="row">
    <div class="span12">
        <div class="page-header">
            <h1>Recent activity</h1>
        </div>
        <div class="moves"></div>
    </div>
</div>

#{set 'script'}
<script src="#{static-path '/public/js/editor.js'/}"></script>
<script src="#{static-path '/public/js/explorer.js'/}"></script>
#{/set}


